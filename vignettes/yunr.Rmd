---
title: "yunr Package Vignette"
author: "Yun Zhang"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{yunr Package Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Introduction

```{r}
library(yunr)
```

This package is built based on the homework content for BST550 Genomic Data Analysis Using R/Bioconductor (Fall 2015). This package only contains one function. It will serve more like a template for building R packages in the future.

# Weighted Rank Sum Test with Correlation

We've extended the two-sample Mann-Whitney U test (or Wilcoxon rank sum test) to allow correlation and weights for the elements in the test group. The function `weightedRankSumTestWithCorrelation()` is an R implementation of such a test. If no correlation and no weighting, this function should produced the same result as `Wilcox.test()` (except tiny arithmetic discrepancy). The correlation only extension of the Wilcoxon rank sum test is available using `rankSumTestWithCorrelation()` in the `limma` package. Our function is edtied based on `limma`'s function. If `weight=NULL`, both function should have the same result (except tiny arithmetic discrepancy). 

It is commonly known that the Mann-Whitney U test and the Wilcoxon rank sum test are equivalant, though the ranks defined by Mann-Whitney and the ranks defined by Wilcoxon are different. These two ways of definition are also equivalent if there's correlation. However, in our case, if we want to weigh the observations differently in the test group, these two types of ranks are no longer equivalent. We can only adopt the Mann-Whitney's rank and use the U-statistic for our test. Same as `limma`, we also assume that the observations in the second group are independent of each other and of the test group.

## Example

```{r}
set.seed(1)
stat <- rnorm(100)
index <- 1:10
stat[index] <- stat[1:10]+1
weight <- runif(length(index), 0, 1)

weightedRankSumTestWithCorrelation(index, stat)
weightedRankSumTestWithCorrelation(index, stat, correlation=0.1)
weightedRankSumTestWithCorrelation(index, stat, weight=weight, correlation=0.1)

## Wilcoxon rank sum test
group <- rep(2,100)
group[index] <- 1
group <- factor(group)
wilcox.test(stat ~ group, alternative = "less")
wilcox.test(stat ~ group, alternative = "greater")

## rank sum test with correlation
library(limma)
rankSumTestWithCorrelation(index, stat, correlation=0.1)
```

## See Also
```{r}
?wilcox.test()
?rankSumTestWithCorrelation()
```


# Session Info

```{r}
sessionInfo()
```
